/* Builder Left Panel */
.tw-builder__left-panel {
    background-color: var(--panels-background);
    border-radius: var(--panels-radius);
    border: 1px solid var(--border-light-color);
    box-shadow: 0 2px 4px 0 var(--shadow-light-color);
    display: flex;
    flex-direction: column;
    height: 100%;
    max-height: 100%;
    overflow: hidden;
}

/* Panel closed state */
.tw-builder__left-panel--closed {
    max-height: 50px;
    height: 50px;
}

/* Panel header section */
.tw-builder__left-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px;
    border-bottom: 1px solid var(--border-light-color);
}

/* Panel toggle button */
.tw-builder__panel-toggle-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    transition: all 0.2s ease;
    color: var(--toggle-color);
    display: flex;
    align-items: center;
    justify-content: center;
}

.tw-builder__panel-toggle-btn svg {
    width: 16px;
    height: 16px;
    transition: transform 0.2s ease;
    rotate: 90deg;
}

/* Rotate icon when panel is closed */
.tw-builder__left-panel--closed .tw-builder__panel-toggle-btn svg {
    transform: rotate(180deg);
}

/* Logo Button */
.tw-builder__logo-button {
    display: flex;
    align-items: center;
    gap: 10px;
    background-color: var(--logo-background);
    border: 1px solid var(--border-light-color);
    box-shadow: 0 2px 4px 0 var(--shadow-light-color);
    border-radius: 6px;
    padding: 7px;
    cursor: pointer;
}

/* Logo arrow icon */
.tw-builder__logo-arrow {
    width: 12px;
    height: 12px;
    transition: transform 0.2s ease;
    rotate: 180deg;
    color: var(--body-strong-color);
}

/* Logo dropdown container */
.builder-logo-dropdown {
    position: relative;
}
.builder-logo-dropdown .dropdown__menu {
    min-width: 200px;
    background: var(--dropdown-background);
    border: 1px solid var(--border-light-color);
    border-radius: 8px;
    box-shadow: 0 2px 4px 0 var(--shadow-light-color);
    margin-top: 15px;
    transform-origin: top left;
}

/* Dropdown menu items */
.dropdown__item.tw-builder__dropdown-item {
    padding: 5px 8px;
    color: var(--body-strong-color);
}
.dropdown__item.tw-builder__dropdown-item--home,
.dropdown__item.tw-builder__dropdown-item--help {
    padding: 8px;
}

/* Tab and Tree Container */
.tw-builder__tab-tree-container {
    padding: 0 10px;
}

.tw-builder__tab-tree-divider {
    height: 1px;
    background-color: var(--border-light-color);
    margin: 0 0 10px 0;
}

/* ==========================================================================
   TAB SECTION
   ========================================================================== */

/* Tab section container */
.tw-builder__tab-section {
    padding: 10px 0;
}

/* Tab container with animated slider */
.tw-builder__tab-container {
    display: flex;
    background-color: var(--tab-container-background);
    border-radius: 8px;
    padding: 3px;
    gap: 3px;
    position: relative;
}

/* Animated tab slider */
.tw-builder__tab-slider {
    position: absolute;
    top: 3px;
    left: 3px;
    width: calc(50% - 3px);
    height: calc(100% - 6px);
    background-color: var(--tab-slider-background);
    border-radius: 6px;
    border: 1px solid var(--border-light-color);
    box-shadow: 0 2px 4px 0 var(--shadow-light-color);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Individual tab buttons */
.tw-builder__tab {
    flex: 1;
    padding: 6px 16px;
    border: 1px solid transparent;
    background: none;
    border-radius: 6px;
    font-size: var(--font-size-mini);
    font-weight: var(--font-weight);
    letter-spacing: var(--letter-spacing-negative);
    color: var(--tab-color);
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.tw-builder__tab--active {
    color: var(--tab-active-color);
}

.tw-builder__tab:hover:not(.tw-builder__tab--active) {
    background-color: var(--tab-hover-background);
    color: var(--tab-hover-color);
}

/* ==========================================================================
   TREE VIEW
   ========================================================================== */

/* Tree content container */
.tw-builder__tree-content {
    flex: 1;
    overflow: auto;
}
.tw-builder__tree-content::-webkit-scrollbar {
    display: none;
}

/* Tree container */
.tw-builder__tree-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    min-width: max-content;
    position: relative;
}

/* ==========================================================================
   TREE ITEMS
   ========================================================================== */

/* Tree item container */
.tw-builder__tree-item {
    position: relative;
}


/* ==========================================================================
   TREE ITEM STATES
   ========================================================================== */

/* Tree item collapsed state */
.tw-builder__tree-item--collapsed .tw-builder__tree-children {
    display: none;
}

/* Tree item collapsed header */
.tw-builder__tree-item--collapsed .tw-builder__tree-item-header--selected {
    border-radius: 8px;
}

/* Tree item without children */
.tw-builder__tree-item:not(.tw-builder__tree-item--has-children) .tw-builder__tree-item-header--selected {
    border-radius: 8px;
}

/* ==========================================================================
   TREE ITEM DEEP NESTING
   ========================================================================== */

/* Tree item deep nesting (level 6 and above to avoid collapsing) */
.tw-builder__tree-item--deep-nesting {
    min-width: 100px;
}

.tw-builder__tree-item--deep-nesting .tw-builder__tree-item-header {
    min-width: 100%;
}

.tw-builder__tree-item--deep-nesting .tw-builder__tree-item-label {
    min-width: 0;
    flex-shrink: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Tree Item Header */
.tw-builder__tree-item-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 10px;
    border-radius: 6px;
    cursor: pointer;
    position: relative;
    width: 100%;
    user-select: none;
}

/* Tree item header hover state */
.tw-builder__tree-item-header:hover:not(.tw-builder__tree-item-header--selected):not(.tw-builder__tree-item-header--child-selected):not(.tw-builder__tree-item-header--child-selected-intermediate) {
    background-color: var(--tree-item-hover-background);
}

.tw-builder__tree-item-header:active {
    cursor: grabbing;
}

/* Tree Item Header States */
.tw-builder__tree-item-header--selected {
    background-color: var(--tree-item-selected-background);
    color: var(--tree-item-selected-color);
    border-radius: 8px 8px 0 0;
}

/* ==========================================================================
   TREE ITEM SELECTED STATES
   ========================================================================== */

/* Selected tree item icon colors */
.tw-builder__tree-item-header--selected .tw-builder__tree-item-square-icon {
    background-color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--selected .tw-builder__tree-item-text-icon {
    color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--selected .tw-builder__tree-item-image-icon {
    fill: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--selected .tw-builder__tree-item-divider-icon {
    background-color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--selected .tw-builder__tree-item-button-icon {
    background-color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--selected .tw-builder__tree-item-button-icon::after {
    background-color: var(--square-icon-background);
}

.tw-builder__tree-item-header--selected .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-selected-color);
}

.tw-builder__tree-item-header--selected .tw-builder__tree-item-label {
    color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--child-selected {
    background-color: transparent;
    color: var(--tree-item-child-selected-color);
    border-radius: 0 0 8px 8px;
}

/* Child selected intermediate tree item icon colors */
.tw-builder__tree-item-header--child-selected .tw-builder__tree-item-square-icon {
    background-color: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--child-selected .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-child-selected-color);
}

.tw-builder__tree-item-header--child-selected .tw-builder__tree-item-label {
    color: var(--child-selected-color);
}

.tw-builder__tree-item-header--child-selected-intermediate {
    background-color: transparent;
    color: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--child-selected-intermediate .tw-builder__tree-item-square-icon {
    background-color: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--child-selected-intermediate .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-child-selected-color);
}

.tw-builder__tree-item-header--child-selected-intermediate .tw-builder__tree-item-label {
    color: var(--child-selected-color);
}

.tw-builder__tree-item-header--collapsed {
    border-radius: 8px;
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child {
    background-color: var(--tree-childs-background);
    color: var(--tree-item-child-selected-color);
    border-radius: 8px;
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child:hover {
    background-color: var(--tree-childs-background) !important;
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child * {
    color: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child .tw-builder__tree-item-square-icon {
    background-color: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child .tw-builder__tree-item-image-icon {
    fill: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child .tw-builder__tree-item-divider-icon {
    background-color: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child .tw-builder__tree-item-button-icon {
    background-color: var(--tree-item-child-selected-color);
}

.tw-builder__tree-item-header--collapsed-parent-with-selected-child .tw-builder__tree-item-button-icon::after {
    background-color: var(--square-icon-background);
}

/* Tree Item Header Drag States */
.tw-builder__tree-item-header--dragging {
    opacity: 1;
    transform: scale(0.95);
    background-color: var(--tree-item-hover-background);
}

/* Tree item header drag over state */
.tw-builder__tree-item-header--drag-over {
    background-color: transparent;
}

/* Tree item header drag over inside position */
.tw-builder__tree-item-header--drag-over[data-position="inside"] {
    background-color: var(--tree-item-selected-background);
    color: var(--tree-item-selected-color);
}

/* Tree item header drag over inside position icons */
.tw-builder__tree-item-header--drag-over[data-position="inside"] .tw-builder__tree-item-square-icon,
.tw-builder__tree-item-header--drag-over[data-position="inside"] .tw-builder__tree-item-divider-icon,
.tw-builder__tree-item-header--drag-over[data-position="inside"] .tw-builder__tree-item-button-icon {
    background-color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--drag-over[data-position="inside"] .tw-builder__tree-item-text-icon,
.tw-builder__tree-item-header--drag-over[data-position="inside"] .tw-builder__tree-item-label {
    color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--drag-over[data-position="inside"] .tw-builder__tree-item-image-icon {
    fill: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--drag-over[data-position="inside"] .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-selected-color);
}


/* Tree item header drag over for before/after positions */
.tw-builder__tree-item-header--drag-over[data-position="before"],
.tw-builder__tree-item-header--drag-over[data-position="after"] {
    background-color: transparent;
    color: inherit;
}

.tw-builder__tree-item-header--drag-over[data-position="before"] .tw-builder__tree-item-square-icon,
.tw-builder__tree-item-header--drag-over[data-position="after"] .tw-builder__tree-item-square-icon {
    background-color: var(--square-icon-background);
}

.tw-builder__tree-item-header--drag-over[data-position="before"] .tw-builder__tree-item-text-icon,
.tw-builder__tree-item-header--drag-over[data-position="after"] .tw-builder__tree-item-text-icon {
    color: var(--tree-text-icon-color);
}

.tw-builder__tree-item-header--drag-over[data-position="before"] .tw-builder__tree-item-image-icon,
.tw-builder__tree-item-header--drag-over[data-position="after"] .tw-builder__tree-item-image-icon {
    fill: var(--square-icon-background);
}

.tw-builder__tree-item-header--drag-over[data-position="before"] .tw-builder__tree-item-divider-icon,
.tw-builder__tree-item-header--drag-over[data-position="after"] .tw-builder__tree-item-divider-icon {
    background-color: var(--tree-text-icon-color);
}

.tw-builder__tree-item-header--drag-over[data-position="before"] .tw-builder__tree-item-button-icon,
.tw-builder__tree-item-header--drag-over[data-position="after"] .tw-builder__tree-item-button-icon {
    background-color: var(--tree-text-icon-color);
}

.tw-builder__tree-item-header--drag-over[data-position="before"] .tw-builder__tree-expand-button,
.tw-builder__tree-item-header--drag-over[data-position="after"] .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-color);
}

.tw-builder__tree-item-header--drag-over[data-position="before"] .tw-builder__tree-item-label,
.tw-builder__tree-item-header--drag-over[data-position="after"] .tw-builder__tree-item-label {
    color: var(--subtitle-color);
}

/* Tree Item Header Toolbar Drag States */
.tw-builder__tree-item-header--toolbar-drag-over {
    background-color: transparent;
}

/* Tree item header toolbar drag over inside position */
.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] {
    background-color: var(--tree-item-selected-background);
    color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] .tw-builder__tree-item-square-icon,
.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] .tw-builder__tree-item-divider-icon,
.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] .tw-builder__tree-item-button-icon {
    background-color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] .tw-builder__tree-item-text-icon {
    color: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] .tw-builder__tree-item-image-icon {
    fill: var(--tree-item-selected-color);
}

.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-selected-color);
}

.tw-builder__tree-item-header--toolbar-drag-over[data-toolbar-position="inside"] .tw-builder__tree-item-label {
    color: var(--tree-item-selected-color);
}

/* ==========================================================================
   TREE ITEM ICONS
   ========================================================================== */

/* Tree item icon container */
.tw-builder__tree-item-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 1;
    width: 8px;
    height: 8px;
}

/* Square icon */
.tw-builder__tree-item-square-icon {
    width: 100%;
    height: 100%;
    background-color: var(--square-icon-background);
    border-radius: 2px;
    position: relative;
    z-index: 1;
}

/* Text icon */
.tw-builder__tree-item-text-icon {
    font-size: 11px;
    font-weight: bold;
    color: var(--tree-text-icon-color);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 1;
}

/* Image icon */
.tw-builder__tree-item-image-icon {
    min-width: 10px;
    height: 10px;
    fill: var(--square-icon-background);
}

/* Divider icon */
.tw-builder__tree-item-divider-icon {
    width: 100%;
    height: 1px;
    background-color: var(--tree-text-icon-color);
    border-radius: 100px;
}

/* Button icon */
.tw-builder__tree-item-button-icon {
    min-width: 11px;
    height: 8px;
    margin-top: 1px;
    background-color: var(--tree-text-icon-color);
    border-radius: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}
.tw-builder__tree-item-button-icon::after {
    content: "";
    position: absolute;
    width: 4px;
    height: 1px;
    border-radius: 100px;
    background-color: #FFFFFF;
}

/* ==========================================================================
   TREE ITEM LABEL
   ========================================================================== */

/* Tree item label */
.tw-builder__tree-item-label {
    font-size: var(--font-size-mini);
    color: var(--subtitle-color);
    font-weight: var(--font-weight);
    letter-spacing: var(--letter-spacing-negative);
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* ==========================================================================
   TREE EXPAND BUTTON
   ========================================================================== */

/* Tree expand button */
.tw-builder__tree-expand-button {
    width: 8px;
    height: 8px;
    border: none;
    background: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--tree-expand-button-color);
    position: relative;
    z-index: 2;
}

/* Tree expand button collapsed state */
.tw-builder__tree-expand-button:not(.tw-builder__tree-expand-button--expanded) {
    transform: rotate(-90deg);
}

/* ==========================================================================
   TREE CHILDREN
   ========================================================================== */

/* Tree children container */
.tw-builder__tree-children {
    background-color: transparent;
}


/* ==========================================================================
   TREE ITEM DRAGGING CONTAINER
   ========================================================================== */

/* Tree item dragging container */
.tw-builder__tree-item--dragging-container {
    border-radius: 8px;
    overflow: hidden;
    opacity: 0.5;
    transform: scale(0.95);
    background-color: var(--tree-item-hover-background);
    transition: all 0.2s ease;
    padding-left: 0 !important;
    margin-left: var(--drag-indent, 16px);
}

/* Dragging container children header */
.tw-builder__tree-item--dragging-container .tw-builder__tree-children .tw-builder__tree-item-header {
    color: var(--subtitle-color);
    border-radius: 0 0 8px 8px;
    padding: 6px 12px 8px 12px;
    background-color: transparent;
    opacity: 1;
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-square-icon,
.tw-builder__tree-item--dragging-container .tw-builder__tree-item-divider-icon,
.tw-builder__tree-item--dragging-container .tw-builder__tree-item-button-icon {
    background-color: var(--square-icon-background);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-text-icon {
    color: var(--tree-text-icon-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-image-icon {
    fill: var(--tree-text-icon-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-label {
    color: var(--subtitle-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-children {
    opacity: 1;
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-children .tw-builder__tree-item {
    opacity: 1;
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-children .tw-builder__tree-item-label {
    color: var(--subtitle-color);
    opacity: 1;
}

/* Dragging container parent header override */
.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header {
    background-color: transparent;
    color: var(--subtitle-color);
    opacity: 1;
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header .tw-builder__tree-item-square-icon {
    background-color: var(--square-icon-background);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header .tw-builder__tree-item-text-icon {
    color: var(--tree-text-icon-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header .tw-builder__tree-item-image-icon {
    fill: var(--tree-text-icon-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header .tw-builder__tree-item-divider-icon {
    background-color: var(--tree-text-icon-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header .tw-builder__tree-item-button-icon {
    background-color: var(--tree-text-icon-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header .tw-builder__tree-expand-button {
    color: var(--tree-expand-button-color);
}

.tw-builder__tree-item--dragging-container .tw-builder__tree-item-header .tw-builder__tree-item-label {
    color: var(--subtitle-color);
}

/* ==========================================================================
   TREE BACKGROUND EXTEND
   ========================================================================== */

/* Background extend for selected item children */
.tw-builder__tree-item-background-extend {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: var(--tree-childs-background);
    border-radius: 0;
    z-index: 0;
}

/* Background extend for last child of selected parent - with border radius */
.tw-builder__tree-item-header--child-selected + .tw-builder__tree-item-background-extend {
    border-radius: 0 0 8px 8px;
}

/* Hide background extend when dragging */
.tw-builder__tree-item--dragging-container .tw-builder__tree-item-background-extend {
    display: none;
}

/* ==========================================================================
   DROP LINES
   ========================================================================== */

/* Drop line base styles */
.tw-builder__drop-line {
    position: absolute;
    left: 0;
    right: 0;
    height: 2px;
    background-color: #3b82f6;
    z-index: 100;
    border-radius: 2px;
    pointer-events: none;
    box-shadow: 0 0 4px rgba(59, 130, 246, 0.5);
}

/* Drop line before position */
.tw-builder__drop-line--before {
    top: -2px;
}

/* Drop line after position */
.tw-builder__drop-line--after {
    bottom: -2px;
}

/* Toolbar drop line styles */
.tw-builder__drop-line--toolbar {
    background-color: #3b82f6;
    box-shadow: 0 0 4px rgba(59, 130, 246, 0.5);
    height: 2px;
    border-radius: 2px;
}

/* Toolbar drop line before position */
.tw-builder__drop-line--toolbar.tw-builder__drop-line--before {
    top: -2px;
}

/* Toolbar drop line after position */
.tw-builder__drop-line--toolbar.tw-builder__drop-line--after {
    bottom: -2px;
}

/* Toolbar drop line inside position - HIDDEN when inside */
.tw-builder__drop-line--toolbar.tw-builder__drop-line--inside {
    display: none;
}