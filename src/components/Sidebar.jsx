import { useEffect, useState } from 'react';
import { supabase } from '../supabase/supabaseClient';
import { SidebarLink } from './SitebarLink';
import { UserConfig } from './UserConfig';
import { Settings } from './settings';
// names and icons used in the sidebar
export const pages = [
    {
        name: 'Home',
        icon: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="#000000" fill="none">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M13.7025 2.38724C12.704 1.60008 11.296 1.60009 10.2975 2.38724L3.2975 7.90553C2.63602 8.42699 2.25 9.22285 2.25 10.0652V20.0001C2.25 21.5189 3.48122 22.7501 5 22.7501H8.25012L8.25279 16.9992C8.25333 16.0331 9.03668 15.2501 10.0028 15.2501L14 15.2501C14.9665 15.2501 15.75 16.0336 15.75 17.0001V22.7501H19C20.5188 22.7501 21.75 21.5189 21.75 20.0001V10.0652C21.75 9.22285 21.364 8.42699 20.7025 7.90553L13.7025 2.38724ZM14.25 22.7501V17.0001C14.25 16.8621 14.1381 16.7501 14 16.7501L10.0028 16.7501C9.86478 16.7501 9.75287 16.862 9.75279 17L9.75012 22.7501H14.25Z" fill="#000000"></path>
            </svg>
      },
    {
      name: 'Sites',
      icon: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="#000000" fill="none">
      <path d="M11.4224 7.40215C11.6208 6.86595 12.3792 6.86595 12.5776 7.40215L13.4669 9.80538C13.5916 10.1425 13.8575 10.4084 14.1946 10.5331L16.5979 11.4224C17.134 11.6208 17.1341 12.3792 16.5979 12.5776L14.1946 13.4669C13.8575 13.5916 13.5916 13.8575 13.4669 14.1946L12.5776 16.5979C12.3792 17.134 11.6208 17.1341 11.4224 16.5979L10.5331 14.1946C10.4084 13.8575 10.1425 13.5916 9.80538 13.4669L7.40215 12.5776C6.86595 12.3792 6.86595 11.6208 7.40215 11.4224L9.80538 10.5331C10.1425 10.4084 10.4084 10.1425 10.5331 9.80538L11.4224 7.40215Z" fill="#000000"></path>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M2.77997 11.25H4.5C4.91421 11.25 5.25 11.5858 5.25 12C5.25 12.4142 4.91421 12.75 4.5 12.75H2.77997C3.07787 16.4628 5.56818 19.557 8.95538 20.7372C8.95487 20.7365 8.95436 20.7357 8.95385 20.7349C8.19137 19.5689 7.61154 17.9674 7.26327 16.1404C7.1857 15.7336 7.45267 15.3408 7.85956 15.2633C8.26644 15.1857 8.65917 15.4527 8.73673 15.8596C9.06173 17.5644 9.58734 18.9629 10.2093 19.914C10.8446 20.8855 11.4782 21.25 12 21.25C12.5218 21.25 13.1554 20.8855 13.7907 19.914C14.4127 18.9629 14.9383 17.5644 15.2633 15.8596C15.3408 15.4527 15.7336 15.1857 16.1404 15.2633C16.5473 15.3408 16.8143 15.7336 16.7367 16.1404C16.3885 17.9674 15.8086 19.5689 15.0462 20.7349C15.0456 20.7357 15.0451 20.7365 15.0446 20.7372C18.4318 19.557 20.9221 16.4628 21.22 12.75H19.5C19.0858 12.75 18.75 12.4142 18.75 12C18.75 11.5858 19.0858 11.25 19.5 11.25H21.22C20.9221 7.5372 18.4318 4.44295 15.0446 3.26275C15.0451 3.26353 15.0456 3.26432 15.0462 3.2651C15.8086 4.4311 16.3885 6.03261 16.7367 7.85956C16.8143 8.26644 16.5473 8.65917 16.1404 8.73673C15.7336 8.8143 15.3408 8.54733 15.2633 8.14044C14.9383 6.43558 14.4127 5.03709 13.7907 4.08605C13.1554 3.11454 12.5218 2.75 12 2.75C11.4782 2.75 10.8446 3.11454 10.2093 4.08605C9.58734 5.03709 9.06173 6.43558 8.73673 8.14044C8.65917 8.54733 8.26644 8.8143 7.85956 8.73673C7.45267 8.65917 7.1857 8.26644 7.26327 7.85956C7.61154 6.03261 8.19137 4.4311 8.95385 3.2651C8.95436 3.26432 8.95487 3.26354 8.95538 3.26276C5.56818 4.44295 3.07787 7.53721 2.77997 11.25ZM12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25Z" fill="#000000"></path>
            </svg>
    },
    {
        name: 'Reports',
        icon: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="#000000" fill="none">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M4.75 2C3.23122 2 2 3.23122 2 4.75V19.75C2 21.2688 3.23122 22.5 4.75 22.5H19.75C21.2688 22.5 22.5 21.2688 22.5 19.75V4.75C22.5 3.23122 21.2688 2 19.75 2H4.75ZM13 7.25C13 6.83579 12.6642 6.5 12.25 6.5C11.8358 6.5 11.5 6.83579 11.5 7.25V17.25C11.5 17.6642 11.8358 18 12.25 18C12.6642 18 13 17.6642 13 17.25V7.25ZM18 11.25C18 10.8358 17.6642 10.5 17.25 10.5C16.8358 10.5 16.5 10.8358 16.5 11.25V17.25C16.5 17.6642 16.8358 18 17.25 18C17.6642 18 18 17.6642 18 17.25V11.25ZM8 13.25C8 12.8358 7.66421 12.5 7.25 12.5C6.83579 12.5 6.5 12.8358 6.5 13.25V17.25C6.5 17.6642 6.83579 18 7.25 18C7.66421 18 8 17.6642 8 17.25V13.25Z" fill="#000000"></path>
            </svg>
    },
    {
        name: 'Academy',
        icon: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="#000000" fill="none">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M20.5004 8.75C20.9147 8.75 21.2504 9.08579 21.2504 9.5V16.3458L22.625 19.5476C23.0628 20.5676 22.306 21.75 21.1719 21.75H19.829C18.6949 21.75 17.9381 20.5676 18.3759 19.5476L19.7504 16.3458V9.5C19.7504 9.08579 20.0862 8.75 20.5004 8.75Z" fill="#000000"></path>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M11.7723 2.26659C11.9247 2.24447 12.0753 2.24447 12.2277 2.26659C13.7897 2.49325 15.69 3.25556 17.4253 4.09079C19.1782 4.93446 20.8334 5.88771 21.9247 6.54595C23.0251 7.20973 23.0251 8.79027 21.9247 9.45405C20.8334 10.1123 19.1782 11.0655 17.4253 11.9092C15.69 12.7444 13.7897 13.5068 12.2277 13.7334C12.0753 13.7555 11.9247 13.7555 11.7723 13.7334C10.2103 13.5068 8.31003 12.7444 6.5747 11.9092C4.82184 11.0655 3.16661 10.1123 2.07534 9.45405C0.974887 8.79027 0.974887 7.20973 2.07534 6.54595C3.16661 5.88771 4.82184 4.93446 6.5747 4.09079C8.31003 3.25556 10.2103 2.49325 11.7723 2.26659Z" fill="#000000"></path>
        <path d="M5.25 12.9287V16.9996C5.25 17.1985 5.32902 17.3893 5.46967 17.5299C5.47176 17.5319 5.4743 17.5343 5.47722 17.537C5.50464 17.5628 5.56561 17.62 5.59987 17.65C5.67567 17.7163 5.78403 17.8064 5.925 17.9121C6.20685 18.1235 6.61996 18.3981 7.16459 18.6704C8.25631 19.2163 9.87043 19.7496 12 19.7496C14.1296 19.7496 15.7437 19.2163 16.8354 18.6704C17.38 18.3981 17.7932 18.1235 18.075 17.9121C18.216 17.8064 18.3243 17.7163 18.4001 17.65C18.4344 17.62 18.4952 17.5629 18.5227 17.5371L18.5303 17.5299C18.671 17.3893 18.75 17.1985 18.75 16.9996V12.9287C18.5277 13.0404 18.3026 13.1513 18.0758 13.2604C16.3166 14.1071 14.244 14.9562 12.4431 15.2175C12.1478 15.2603 11.8522 15.2603 11.5569 15.2175C9.75601 14.9562 7.6834 14.1071 5.92417 13.2604C5.69738 13.1513 5.47235 13.0404 5.25 12.9287Z" fill="#000000"></path>
    </svg>
    },
    {
        name: 'Legal news',
        icon: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="#000000" fill="none">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 4C2.25 2.48122 3.48122 1.25 5 1.25H17C18.5188 1.25 19.75 2.48122 19.75 4V12.4556C18.8134 11.8509 17.6977 11.5 16.5 11.5C13.1863 11.5 10.5 14.1863 10.5 17.5C10.5 19.759 11.7484 21.7265 13.593 22.75H5C3.48122 22.75 2.25 21.5188 2.25 20V4ZM7.5 6.25C7.08579 6.25 6.75 6.58579 6.75 7C6.75 7.41421 7.08579 7.75 7.5 7.75H14.5C14.9142 7.75 15.25 7.41421 15.25 7C15.25 6.58579 14.9142 6.25 14.5 6.25H7.5ZM7.5 10.25C7.08579 10.25 6.75 10.5858 6.75 11C6.75 11.4142 7.08579 11.75 7.5 11.75H10.5C10.9142 11.75 11.25 11.4142 11.25 11C11.25 10.5858 10.9142 10.25 10.5 10.25H7.5Z" fill="#000000"></path>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 15C15.1193 15 14 16.1193 14 17.5C14 18.8807 15.1193 20 16.5 20C17.1906 20 17.8143 19.7213 18.2678 19.2678C18.7213 18.8143 19 18.1906 19 17.5C19 16.1193 17.8807 15 16.5 15ZM12 17.5C12 15.0147 14.0147 13 16.5 13C18.9853 13 21 15.0147 21 17.5C21 18.3801 20.7467 19.202 20.3098 19.8956L21.7071 21.2929C22.0976 21.6834 22.0976 22.3166 21.7071 22.7071C21.3166 23.0976 20.6834 23.0976 20.2929 22.7071L18.8956 21.3098C18.202 21.7467 17.3801 22 16.5 22C14.0147 22 12 19.9853 12 17.5Z" fill="#000000"></path>
    </svg>
    },
  ];
// Sidebar component
export function Sidebar({ pages, onPageChange }) {
    const [user, setUser] = useState(null);
    const [isUserConfigOpen, setIsUserConfigOpen] = useState(false);
//supa base with dev user
    const _loginDevUser = async () => {
        await supabase.auth.signInWithPassword({
          email: 'oscar.abad.brickscore@gmail.com', 
          password: 'TW.141109'
        });
    };
    
    const getUser = async () => {
        const { data, error } = await supabase.auth.getUser();
        if (error) {
            console.log(error);
        } else {
            setUser(data.user);
        }
    };

    useEffect(() => {
        _loginDevUser();
        getUser(); 
    }, []); 

    return (
        <div className="sidebar-container">
            <SidebarLink
                /* onClick={() => setIsUserConfigOpen(true)} */
                icon={<img className="sidebar__user-avatar" src="https://cdn-icons-png.flaticon.com/512/1308/1308845.png" alt="User" />}
            >

            </SidebarLink>
            <div className="sidebar">
                {/* upper part of the sidebar where we map the pages and icons*/}
                <div className="sidebar__upper">
                    {pages.map((page) => (
                        <SidebarLink
                            key={page.name}
                            icon={page.icon}
                            text={page.name}
                            onClick={() => onPageChange(page.name)}
                        />
                    ))}
                </div>
                {/* lower part of the sidebar where we usea links that open modals*/}
                <div className="sidebar__lower">
                    <SidebarLink
                        onClick={() => setIsUserConfigOpen(true)}
                    >
                        <img className="sidebar__user-avatar" src="https://cdn-icons-png.flaticon.com/512/1308/1308845.png" alt="User" />
                        <span>{user?.user_metadata?.display_name}</span>
                        <span>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="#000000" fill="none">
                                <path d="M18 15L12 9L6 15" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="16" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </span>
                        <span>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="#000000" fill="none">
                                <path d="M18 15L12 9L6 15" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="16" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                        </span>
                    </SidebarLink>
                </div>
                {/* function to open the user config modal*/}
                {isUserConfigOpen && (
                    <UserConfig onClose={() => setIsUserConfigOpen(false)} />
                )}
                {/* <UserConfig /> */}
            </div>
        </div>
    );
}

